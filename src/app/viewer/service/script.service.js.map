{"version":3,"file":"script.service.js","sourceRoot":"","sources":["script.service.ts"],"names":[],"mappings":"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","sourcesContent":["import { Injectable } from '@angular/core';\n\ndeclare var document: any;\n\nexport interface ScriptInfoLookup {\n  [key: string]: ScriptInfo;\n}\n\nexport interface ScriptInfo {\n  src: string;\n  loaded: boolean;\n  status?: string;\n}\n\n@Injectable()\nexport class ScriptService {\n\n  private scripts: ScriptInfoLookup = {};\n\n  constructor() {\n    // Nothing to do\n  }\n\n  public load(...urls: string[]): Promise<ScriptInfo[]> {\n    const promises: Promise<ScriptInfo>[] = [];\n\n    urls.forEach((src) => {\n      if (this.scripts[src] && this.scripts[src].loaded) {\n        return;\n      }\n\n      this.scripts[src] = { src, loaded: false };\n      return promises.push(this.loadScript(src));\n    });\n\n    return Promise.all(promises);\n  }\n\n  public loadScript(name: string): Promise<ScriptInfo> {\n    return new Promise((resolve, reject) => {\n      // resolve if already loaded\n      if (this.scripts[name] && this.scripts[name].loaded) {\n        resolve({ src: name, loaded: true, status: 'Already Loaded' });\n        return;\n      }\n\n      // load script\n      const script = document.createElement('script');\n      script.type = 'text/javascript';\n      script.src = this.scripts[name].src;\n\n      if (script.readyState) {  // IE\n        script.onreadystatechange = () => {\n          if (script.readyState === 'loaded' || script.readyState === 'complete') {\n            script.onreadystatechange = null;\n            this.scripts[name].loaded = true;\n\n            resolve({ src: name, loaded: true, status: 'Loaded' });\n          }\n        };\n      } else {  // Others\n        script.onload = () => {\n          this.scripts[name].loaded = true;\n\n          resolve({ src: name, loaded: true, status: 'Loaded' });\n        };\n      }\n\n      script.onerror = (error: any) => resolve({ src: name, loaded: false, status: 'Loaded' });\n      document.getElementsByTagName('head')[0].appendChild(script);\n    });\n  }\n}\n"]}